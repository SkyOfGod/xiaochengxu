<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.cailanzi.mapper.OrderMapper">

    <select id="getOrderList" resultType="OrderUnion">
        SELECT a.order_id orderId,a.order_num orderNum,a.produce_station_no produceStationNo,
        a.produce_station_name produceStationName,a.buyer_full_name buyerFullName,a.`status`,
        a.buyer_full_address buyerFullAddress,a.buyer_mobile buyerMobile,a.create_time createTime,
        b.sku_id skuId,b.sku_name skuName,b.sku_jd_price skuJdPrice,b.sku_count skuCount,
        b.sku_store_price skuStorePrice,b.sku_cost_price skuCostPrice,b.sku_weight skuWeight,b.sku_status skuStatus
        FROM order_jd a
        JOIN product_order_jd b ON b.order_id = a.order_id
        <where>
            <if test="orderId!=null and orderId.trim()!=''">
                AND a.order_id = #{orderId}
            </if>
        </where>
    </select>

    <!--
    收货员端 获取待备货/待收货/待配送/已完成/退货订单
    -->
    <select id="getOrderShopJdList" resultType="OrderUnion">
        SELECT a.order_id orderId,a.order_num orderNum,b.sku_id skuId,b.sku_name skuName,
        b.sku_count skuCount,b.sku_store_price skuStorePrice,b.sku_status skuStatus,
        a.order_buyer_remark orderBuyerRemark,a.create_time createTime
        FROM order_jd a
        JOIN product_order_jd b ON b.order_id=a.order_id
        WHERE a.produce_station_no = #{belongStationNo} AND a.`status` = #{orderStatus}
        <if test="startTime != null and endTime != null">
            AND a.create_time BETWEEN #{startTime} AND #{endTime}
        </if>
    </select>

</mapper>